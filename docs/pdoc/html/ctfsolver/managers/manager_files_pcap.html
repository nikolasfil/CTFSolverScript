<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>ctfsolver.managers.manager_files_pcap API documentation</title>
<meta name="description" content="manager_files_pcap.py …">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ctfsolver.managers.manager_files_pcap</code></h1>
</header>
<section id="section-intro">
<p>manager_files_pcap.py</p>
<p>This module provides the ManagerFilePcap class for handling and analyzing PCAP files using Scapy.
It offers methods to open PCAP files, filter ICMP packets, extract TTL values, and search for specific text within packet payloads.</p>
<h2 id="classes">Classes</h2>
<p>ManagerFilePcap: Manages PCAP file operations and packet analysis.</p>
<p>Typical usage example:
manager = ManagerFilePcap()
packets = manager.pcap_open(file=path_to_pcap)
icmp_packets = manager.get_packets_icmp(packets)
ttl_values = manager.get_packet_ttl(icmp_packets)
found_text = manager.searching_text_in_packets("flag", packets)</p>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ctfsolver.managers.manager_files_pcap.ManagerFilePcap"><code class="flex name class">
<span>class <span class="ident">ManagerFilePcap</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ManagerFilePcap:
    &#34;&#34;&#34;
    ManagerFilePcap provides methods for handling and analyzing PCAP files using Scapy.
    This class allows you to open PCAP files, filter packets by protocol (such as ICMP),
    extract specific packet attributes (like TTL), and search for text within packet payloads.
    Attributes:
        packets (list[scapy.packet.Packet]): List of packets loaded from a PCAP file.
        challenge_file (Path): Default file path for PCAP operations.
    Methods:
        initializing_all_ancestors(*args, **kwargs):
            Initializes all ancestors of the class.
        pcap_open(file=None, save=False) -&gt; list[scapy.packet.Packet] | None:
            Opens a PCAP file and loads packets using Scapy.
        get_packets_icmp(packets=None) -&gt; list:
            Retrieves all ICMP packets from the loaded packets.
        get_packet_ttl(packets=None) -&gt; list:
            Extracts the TTL values from the provided packets.
        searching_text_in_packets(text, packets=None, display=False) -&gt; str:
            Searches for a specific text in packet payloads and optionally displays matching packets.
    &#34;&#34;&#34;

    def __init__(self, *args, **kwargs):
        pass

    def initializing_all_ancestors(self, *args, **kwargs):
        &#34;&#34;&#34;
        Description:
            Initializes all the ancestors of the class
            Placeholder for overwrite

        &#34;&#34;&#34;
        pass

    def pcap_open(self, file=None, save=False) -&gt; list[scapy.packet.Packet] | None:
        &#34;&#34;&#34;
        Description:
            Open the pcap file with scapy and saves it in self.packets

        Args:
            file (Path, optional): File to open. Defaults to None.
            save (bool, optional): Save the output. Defaults to False.
        &#34;&#34;&#34;

        if file is None:
            file = self.challenge_file

        self.packets = scapy.rdpcap(file.as_posix())

        # In later versions this should be changed
        if save:
            return self.packets

    def get_packets_icmp(self, packets=None):
        &#34;&#34;&#34;
        Description:
        Get all the ICMP packets from the packets

        Args:
            packets (list, optional): List of packets to search in. Defaults to None.

        Returns:
            list: List of ICMP packets
        &#34;&#34;&#34;

        if packets is None:
            packets = self.packets

        icmp_packets = [packet for packet in packets if packet.haslayer(&#34;ICMP&#34;)]

        return icmp_packets

    def get_packet_ttl(self, packets=None):
        &#34;&#34;&#34;
        Description:
        Get the TTL of all the ICMP packets

        Args:
            packets (list, optional): List of packets to search in. Defaults to None.

        Returns:
            list: List of TTL of the ICMP packets
        &#34;&#34;&#34;
        if packets is None:
            packets = self.packets

        icmp_ttl = [packet.ttl for packet in packets]

        return icmp_ttl

    def searching_text_in_packets(self, text, packets=None, display=False):
        &#34;&#34;&#34;
        Description:
        Search for a text in the packets that have been opened with scapy

        Args:
            text (str): Text to search in the packets
            packets (list, optional): List of packets to search in. Defaults to None.
            display (bool, optional): Display the packet if the text is found. Defaults to False.

        Returns:
            str: Text found in the packet if found
        &#34;&#34;&#34;

        if packets is None:
            packets = self.packets

        for i, packet in enumerate(packets):
            if packet.haslayer(&#34;Raw&#34;):
                if text.encode() in packet[&#34;Raw&#34;].load:
                    if display:
                        print(f&#34;Found {text} in packet {i}&#34;)
                        print(packet.show())
                        print(packet.summary())
                    return packet[&#34;Raw&#34;].load.decode(&#34;utf-8&#34;)</code></pre>
</details>
<div class="desc"><p>ManagerFilePcap provides methods for handling and analyzing PCAP files using Scapy.
This class allows you to open PCAP files, filter packets by protocol (such as ICMP),
extract specific packet attributes (like TTL), and search for text within packet payloads.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>packets</code></strong> :&ensp;<code>list[scapy.packet.Packet]</code></dt>
<dd>List of packets loaded from a PCAP file.</dd>
<dt><strong><code>challenge_file</code></strong> :&ensp;<code>Path</code></dt>
<dd>Default file path for PCAP operations.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>initializing_all_ancestors(<em>args, </em>*kwargs):
Initializes all ancestors of the class.
pcap_open(file=None, save=False) -&gt; list[scapy.packet.Packet] | None:
Opens a PCAP file and loads packets using Scapy.
get_packets_icmp(packets=None) -&gt; list:
Retrieves all ICMP packets from the loaded packets.
get_packet_ttl(packets=None) -&gt; list:
Extracts the TTL values from the provided packets.
searching_text_in_packets(text, packets=None, display=False) -&gt; str:
Searches for a specific text in packet payloads and optionally displays matching packets.</p></div>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ctfsolver.managers.manager_file.ManagerFile" href="manager_file.html#ctfsolver.managers.manager_file.ManagerFile">ManagerFile</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.get_packet_ttl"><code class="name flex">
<span>def <span class="ident">get_packet_ttl</span></span>(<span>self, packets=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_packet_ttl(self, packets=None):
    &#34;&#34;&#34;
    Description:
    Get the TTL of all the ICMP packets

    Args:
        packets (list, optional): List of packets to search in. Defaults to None.

    Returns:
        list: List of TTL of the ICMP packets
    &#34;&#34;&#34;
    if packets is None:
        packets = self.packets

    icmp_ttl = [packet.ttl for packet in packets]

    return icmp_ttl</code></pre>
</details>
<div class="desc"><p>Description:
Get the TTL of all the ICMP packets</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>packets</code></strong> :&ensp;<code>list</code>, optional</dt>
<dd>List of packets to search in. Defaults to None.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>List of TTL of the ICMP packets</dd>
</dl></div>
</dd>
<dt id="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.get_packets_icmp"><code class="name flex">
<span>def <span class="ident">get_packets_icmp</span></span>(<span>self, packets=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_packets_icmp(self, packets=None):
    &#34;&#34;&#34;
    Description:
    Get all the ICMP packets from the packets

    Args:
        packets (list, optional): List of packets to search in. Defaults to None.

    Returns:
        list: List of ICMP packets
    &#34;&#34;&#34;

    if packets is None:
        packets = self.packets

    icmp_packets = [packet for packet in packets if packet.haslayer(&#34;ICMP&#34;)]

    return icmp_packets</code></pre>
</details>
<div class="desc"><p>Description:
Get all the ICMP packets from the packets</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>packets</code></strong> :&ensp;<code>list</code>, optional</dt>
<dd>List of packets to search in. Defaults to None.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>List of ICMP packets</dd>
</dl></div>
</dd>
<dt id="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.initializing_all_ancestors"><code class="name flex">
<span>def <span class="ident">initializing_all_ancestors</span></span>(<span>self, *args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def initializing_all_ancestors(self, *args, **kwargs):
    &#34;&#34;&#34;
    Description:
        Initializes all the ancestors of the class
        Placeholder for overwrite

    &#34;&#34;&#34;
    pass</code></pre>
</details>
<div class="desc"><h2 id="description">Description</h2>
<p>Initializes all the ancestors of the class
Placeholder for overwrite</p></div>
</dd>
<dt id="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.pcap_open"><code class="name flex">
<span>def <span class="ident">pcap_open</span></span>(<span>self, file=None, save=False) ‑> list[scapy.packet.Packet] | None</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def pcap_open(self, file=None, save=False) -&gt; list[scapy.packet.Packet] | None:
    &#34;&#34;&#34;
    Description:
        Open the pcap file with scapy and saves it in self.packets

    Args:
        file (Path, optional): File to open. Defaults to None.
        save (bool, optional): Save the output. Defaults to False.
    &#34;&#34;&#34;

    if file is None:
        file = self.challenge_file

    self.packets = scapy.rdpcap(file.as_posix())

    # In later versions this should be changed
    if save:
        return self.packets</code></pre>
</details>
<div class="desc"><h2 id="description">Description</h2>
<p>Open the pcap file with scapy and saves it in self.packets</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file</code></strong> :&ensp;<code>Path</code>, optional</dt>
<dd>File to open. Defaults to None.</dd>
<dt><strong><code>save</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Save the output. Defaults to False.</dd>
</dl></div>
</dd>
<dt id="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.searching_text_in_packets"><code class="name flex">
<span>def <span class="ident">searching_text_in_packets</span></span>(<span>self, text, packets=None, display=False)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def searching_text_in_packets(self, text, packets=None, display=False):
    &#34;&#34;&#34;
    Description:
    Search for a text in the packets that have been opened with scapy

    Args:
        text (str): Text to search in the packets
        packets (list, optional): List of packets to search in. Defaults to None.
        display (bool, optional): Display the packet if the text is found. Defaults to False.

    Returns:
        str: Text found in the packet if found
    &#34;&#34;&#34;

    if packets is None:
        packets = self.packets

    for i, packet in enumerate(packets):
        if packet.haslayer(&#34;Raw&#34;):
            if text.encode() in packet[&#34;Raw&#34;].load:
                if display:
                    print(f&#34;Found {text} in packet {i}&#34;)
                    print(packet.show())
                    print(packet.summary())
                return packet[&#34;Raw&#34;].load.decode(&#34;utf-8&#34;)</code></pre>
</details>
<div class="desc"><p>Description:
Search for a text in the packets that have been opened with scapy</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>text</code></strong> :&ensp;<code>str</code></dt>
<dd>Text to search in the packets</dd>
<dt><strong><code>packets</code></strong> :&ensp;<code>list</code>, optional</dt>
<dd>List of packets to search in. Defaults to None.</dd>
<dt><strong><code>display</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Display the packet if the text is found. Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>Text found in the packet if found</dd>
</dl></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ctfsolver.managers" href="index.html">ctfsolver.managers</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ctfsolver.managers.manager_files_pcap.ManagerFilePcap" href="#ctfsolver.managers.manager_files_pcap.ManagerFilePcap">ManagerFilePcap</a></code></h4>
<ul class="">
<li><code><a title="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.get_packet_ttl" href="#ctfsolver.managers.manager_files_pcap.ManagerFilePcap.get_packet_ttl">get_packet_ttl</a></code></li>
<li><code><a title="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.get_packets_icmp" href="#ctfsolver.managers.manager_files_pcap.ManagerFilePcap.get_packets_icmp">get_packets_icmp</a></code></li>
<li><code><a title="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.initializing_all_ancestors" href="#ctfsolver.managers.manager_files_pcap.ManagerFilePcap.initializing_all_ancestors">initializing_all_ancestors</a></code></li>
<li><code><a title="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.pcap_open" href="#ctfsolver.managers.manager_files_pcap.ManagerFilePcap.pcap_open">pcap_open</a></code></li>
<li><code><a title="ctfsolver.managers.manager_files_pcap.ManagerFilePcap.searching_text_in_packets" href="#ctfsolver.managers.manager_files_pcap.ManagerFilePcap.searching_text_in_packets">searching_text_in_packets</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
